sequenceDiagram
    autonumber

    participant U as User 🧔
    participant TS as Touch Sensor 🔘
    participant GPIO as GPIO Service 🔄
    participant DM as Dream Machine 🖥️
    participant OpenAI as OpenAI 🤖
    participant LL as LumaLabs 🤖
    
    Note over U,DM: Device in Clock View
    U ->> TS: Double tap 👆👆 (start recording)
    TS ->> GPIO: Detects double tap pattern
    GPIO ->> DM: Sends start recording request
    DM ->> U: Shows recording UI 🔴
    U ->> DM: Voices dream 🗣️
    U ->> TS: Single tap 👆 (stop recording)
    TS ->> GPIO: Detects single tap pattern
    GPIO ->> DM: Sends stop recording request
    
    Note over DM,OpenAI: Processing Dream
    DM ->> OpenAI: Sends dream voice for STT 🎶
    OpenAI -->> DM: Returns voice text 📃
    DM ->> U: Shows transcription 📝
    
    DM ->> OpenAI: Sends voice text for Video Prompt creation 📃
    OpenAI -->> DM: Returns Video Prompt 📃
    
    DM ->> LL: Sends Video Prompt for video creation 📃
    DM -->> DM: Awaits response 💤
    
    LL -->> DM: Returns video URL 🔗
    DM ->> U: Plays video 📺️
    
    Note over U,DM: Viewing Dreams
    U ->> TS: Single tap 👆 (view dream)
    TS ->> GPIO: Detects single tap pattern
    GPIO ->> DM: Sends show dream request
    DM ->> U: Plays dream video 📽️
    U ->> TS: Single tap 👆 (next dream)
    TS ->> GPIO: Detects single tap pattern
    GPIO ->> DM: Sends next dream request
    DM ->> U: Plays next dream video 📽️
    U ->> TS: Double tap 👆👆 (return to clock)
    TS ->> GPIO: Detects double tap pattern
    GPIO ->> DM: Sends return to clock request
    DM ->> U: Shows clock view 🕐

    % DM -->> DM: Proprietary conversion ⁉️