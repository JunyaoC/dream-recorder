<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dream Library</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/static/css/dreams.css">
</head>
<body>
    <div class="dreams-grid">
        {% for dream in dreams %}
        <div class="dream-card" data-id="{{ dream.id }}"
             data-user-prompt="{{ dream.user_prompt }}"
             data-generated-prompt="{{ dream.generated_prompt }}"
             data-created-at="{{ dream.created_at }}"
             data-video-url="/media/video/{{ dream.video_filename }}"
             data-audio-url="/media/audio/{{ dream.audio_filename }}">
            <img src="/media/thumbs/{{ dream.thumb_filename }}" 
                 alt="Dream thumbnail" 
                 class="dream-thumbnail">
            <div class="dream-info">
                <div class="dream-date">{{ dream.created_at }}</div>
                {{ dream.user_prompt[:50] }}{% if dream.user_prompt|length > 50 %}...{% endif %}
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Dream Details Modal -->
    <div class="modal" id="dreamModal">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <div class="modal-section">
                <h3>Your dream</h3>
                <p id="modalUserPrompt"></p>
            </div>
            <div class="modal-section">
                <h3>The prompt</h3>
                <p id="modalGeneratedPrompt"></p>
            </div>
            <div class="modal-section">
                <h3>Created at</h3>
                <p id="modalCreatedAt"></p>
            </div>
            <div class="modal-actions">
                <a href="#" id="modalAudioLink" target="_blank">
                    <i class="bi bi-music-note"></i> Listen to Audio
                </a>
                <a href="#" id="modalVideoLink" target="_blank">
                    <i class="bi bi-play-circle"></i> Watch Video
                </a>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('dreamModal');
            const dreamCards = document.querySelectorAll('.dream-card');
            const modalClose = document.querySelector('.modal-close');

            dreamCards.forEach(card => {
                card.addEventListener('click', function() {
                    const data = this.dataset;
                    
                    document.getElementById('modalUserPrompt').textContent = data.userPrompt;
                    document.getElementById('modalGeneratedPrompt').textContent = data.generatedPrompt;
                    document.getElementById('modalCreatedAt').textContent = data.createdAt;
                    
                    document.getElementById('modalAudioLink').href = data.audioUrl;
                    document.getElementById('modalVideoLink').href = data.videoUrl;
                    
                    modal.classList.add('show');
                });
            });

            modalClose.addEventListener('click', function() {
                modal.classList.remove('show');
            });

            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.classList.remove('show');
                }
            });
        });
    </script>
</body>
</html> 